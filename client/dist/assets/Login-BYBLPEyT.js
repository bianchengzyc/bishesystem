import{u as h,r as m,a as y,c as V,b as c,d as o,w as t,e as a,f as k,o as x,g as C,E as d}from"./index-B6SUqF8J.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"login-container"},R={class:"login-form-wrapper"},S={__name:"Login",setup(B){const f=k(),g=h(),l=m(),n=m(!1),s=y({username:"",password:""}),_={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},w=async()=>{if(l.value)try{await l.value.validate(),n.value=!0;const r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),e=await r.json();r.ok&&e.token?(g.login(e.user,e.token),d.success("登录成功"),f.push("/images")):d.error(e.message||"登录失败")}catch(r){console.error("Login error:",r),d.error("登录失败，请检查网络连接")}finally{n.value=!1}};return(r,e)=>{const p=a("el-input"),u=a("el-form-item"),v=a("el-button"),b=a("el-form");return x(),V("div",N,[c("div",R,[e[3]||(e[3]=c("h2",null,"单株枯死云杉高精度检测数据系统",-1)),o(b,{model:s,rules:_,ref_key:"loginFormRef",ref:l,"label-width":"80px",class:"login-form"},{default:t(()=>[o(u,{label:"用户名",prop:"username"},{default:t(()=>[o(p,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=i=>s.username=i),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),o(u,{label:"密码",prop:"password"},{default:t(()=>[o(p,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=i=>s.password=i),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1}),o(u,null,{default:t(()=>[o(v,{type:"primary",class:"login-button",onClick:w,loading:n.value},{default:t(()=>[...e[2]||(e[2]=[C(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}},T=L(S,[["__scopeId","data-v-e5f9e92d"]]);export{T as default};
